@using Controls.Collapsibles
@using Controls.Buttons
@using Controls.Selection
@using Controls.Css

<span>
    <Button
        OnClick=OnClick
        Class=@SelectedClass
    >
        <CollapsibleSelector IsCollapsed="isSelected">@Text</CollapsibleSelector>
    </Button>

    <div class="nav-header-children">
        <Collapsible IsCollapsed="isSelected">
            <CascadingValue Value=this IsFixed=true>
                @ChildContent
            </CascadingValue>
        </Collapsible>
    </div>
</span>


@code {
    private bool isSelected;

    private string? SelectedClass => isSelected ? "selected fade" : null;

    [CascadingParameter]
    public NavHeader? CurrentHeader { get; set; }

    [Parameter, EditorRequired]
    public string? Text { get; set; }

    [Parameter, EditorRequired]
    public RenderFragment? ChildContent { get; set; }

    public void Select(bool isSelected)
    {
        this.isSelected = isSelected;
        StateHasChanged();
        CurrentHeader?.Select(isSelected);
    }

    private void OnClick() => isSelected = !isSelected;
}
